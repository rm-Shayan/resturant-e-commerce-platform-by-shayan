<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant E-Commerce</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

    <!-- Navigation -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center p-5">
            <h1 class="text-3xl font-bold text-green-600">Restaurant E-Commerce</h1>
            
            <!-- Menu for Mobile -->
            <button id="menuToggle" class="md:hidden text-green-600 focus:outline-none text-2xl">
                ☰
            </button>

            <!-- Navigation Links for Desktop -->
            <nav id="navMenu" class="hidden md:flex space-x-6">
                <a href="#" class="hover:text-green-600">Home</a>
                <a href="#" class="hover:text-green-600">Restaurants</a>
                <a href="#" class="hover:text-green-600" id="order">Order</a>
                <a href="#" class="hover:text-green-600" id="cartLink">Cart</a>
                <a href="#" class="hover:text-green-600">Contact</a>
                
                <!-- Profile Section for Desktop -->
                <div class="relative hidden md:block">
                    <input type="file" id="profileUpload" class="hidden" accept="image/*">
                    <img id="profileImage" src="admin-pannel/assets/download.jpeg" alt="Profile"
                        class="w-10 h-10 rounded-full border cursor-pointer">

                    <!-- Profile Dropdown -->
                    <div id="profileDropdown" class="hidden absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg z-50">
                        <ul class="py-2 text-sm text-gray-700">
                            <li>
                                <button id="uploadImage" class="block px-4 py-2 w-full text-left hover:bg-gray-100">
                                    Upload Image
                                </button>
                            </li>
                            <li>
                                <a href="admin-pannel/admin.html" class="block px-4 py-2 hover:bg-gray-100">
                                    Switch to Admin
                                </a>
                            </li>
                            <li>
                                <button id="logout" class="block px-4 py-2 w-full text-left text-red-500 hover:bg-gray-100">
                                    Logout
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>

        <!-- Mobile Menu with Profile -->
        <div id="mobileMenu" class="hidden bg-white md:hidden flex flex-col items-center py-4 space-y-3">
            <a href="#" class="hover:text-green-600">Home</a>
            <a href="#" class="hover:text-green-600">Restaurants</a>
            <a  id="order" class="hover:text-green-600">Order</a>
            <a href="#" class="hover:text-green-600  " id="#cartSidebar button">Cart</a>
            <a href="#" class="hover:text-green-600">Contact</a>

            <!-- Profile Section for Mobile -->
            <div class="relative flex flex-col items-center">
                <input type="file" id="mobileProfileUpload" class="hidden" accept="image/*">
                <img id="mobileProfileImage" src="admin-pannel/assets/download.jpeg" alt="Profile"
                    class="w-16 h-16 rounded-full border cursor-pointer">
                <p class="text-gray-600 mt-2">Upload Profile</p>
            </div>
        </div>
    </header>

<!-- Cart Sidebar -->
<aside id="cartSidebar" class="fixed right-0 top-0 w-80 sm:w-full bg-white shadow-lg h-[80vh] sm:h-full mt-16 sm:mt-0 transform translate-x-full transition-transform duration-300 ease-in-out overflow-y-auto">
    <div class="p-5 border-b flex justify-between items-center">
        <h3 class="text-xl font-bold">Your Cart</h3>
        <button onclick="toggleCart()" class="text-red-500 text-xl">&times;</button>
    </div>
    <div id="cartItemsContainer" class="p-5 space-y-4">
        <!-- Cart items will be dynamically inserted here -->
    </div>
</aside>

<!-- Order Sidebar -->
<aside id="orderSidebar" class="fixed right-0 top-0 w-80 sm:w-full bg-white shadow-lg h-[80vh] sm:h-full mt-16 sm:mt-0 transform translate-x-full transition-transform duration-300 ease-in-out overflow-y-auto">
    <div class="p-5 border-b flex justify-between items-center">
        <h3 class="text-xl font-bold">Your Orders</h3>
        <button onclick="toggleOrderSidebar()" class="text-red-500 text-xl">&times;</button>
    </div>
    <div id="orderItemsContainer" class="p-5 space-y-4">
        <!-- Orders will be dynamically inserted here -->
    </div>
</aside>





    <!-- Hero Section -->
    <section class="bg-green-200 text-center py-16">
        <h2 class="text-4xl font-bold">Find the Best Restaurants Near You</h2>
        <p class="mt-3 text-gray-700">Search for your favorite meals and order instantly</p>
        <div class="mt-6 flex justify-center">
            <input id="searchRestaurant" type="text" placeholder="Search Restaurants..." 
                   class="p-3 w-2/3 md:w-1/3 border rounded-md focus:outline-none focus:ring-2 focus:ring-green-600">
        </div>
    </section>

<!-- Restaurant Section -->
<section class="container mx-auto mt-10">
    <h3 class="text-3xl font-bold text-center mb-6">Top Restaurants</h3>
    <div id="restaurantSection" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <!-- Restaurants will be dynamically inserted here -->










        
        
        
    </div>
    
   

    <!-- Footer -->
    <footer class="bg-gray-800 text-white text-center p-6 mt-10">
        <p>&copy; 2025 Foody - All Rights Reserved</p>
    </footer>


    <!-- JavaScript -->
    <script>
        // Menu Toggle
        document.getElementById('menuToggle').addEventListener('click', () => {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        });

        document.addEventListener("DOMContentLoaded", function () {
        // Default profile image if no image is found in localStorage
        const defaultImage = "admin-pannel/assets/download.jpeg"; 
        
        // Get saved image from localStorage or use default image
        const savedImage = localStorage.getItem("userImage") || defaultImage;

        // Set profile images on page load
        document.getElementById("profileImage").src = savedImage;
        document.getElementById("mobileProfileImage").src = savedImage;
    });

    // Function to handle profile image upload
    function handleProfileImageUpload(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageUrl = e.target.result;

                // Save image to localStorage
                localStorage.setItem("userImage", imageUrl);

                // Update profile images
                document.getElementById("profileImage").src = imageUrl;
                document.getElementById("mobileProfileImage").src = imageUrl;
            };
            reader.readAsDataURL(file);
        }
    }

    // Handle Desktop Profile Image Upload
    document.getElementById("profileUpload").addEventListener("change", handleProfileImageUpload);
    
    
    // Handle Mobile Profile Image Upload
    document.getElementById("mobileProfileUpload").addEventListener("change", handleProfileImageUpload);

    // Profile Dropdown Toggle
    document.getElementById('profileImage').addEventListener('click', (event) => {
        event.stopPropagation();
        document.getElementById('profileDropdown').classList.toggle('hidden');
    });

    // Close dropdown if clicked outside
    document.addEventListener('click', (event) => {
        if (!document.getElementById('profileDropdown').contains(event.target) && event.target.id !== 'profileImage') {
            document.getElementById('profileDropdown').classList.add('hidden');
        }
    });

    // Upload Image Button Click
    document.getElementById('uploadImage').addEventListener('click', () => {
        document.getElementById('profileUpload').click();
    });

    // Mobile Profile Image Click to Upload
    document.getElementById('mobileProfileImage').addEventListener('click', () => {
        document.getElementById('mobileProfileUpload').click();
    });

    // Logout Functionality (Clears Image from LocalStorage)
    document.getElementById('logout').addEventListener('click', () => {
        alert('Logged out successfully!');
        localStorage.removeItem("userImage"); // Clear profile image
        window.location.href = "login.html"; // Redirect to login page
    });




    



    // Function to toggle the cart sidebar
    document.addEventListener("DOMContentLoaded", function () {
    const cartLink = document.getElementById("cartLink");

    if (cartLink) {
        cartLink.addEventListener("click", function (event) {
            event.preventDefault();
            toggleCart();
        });
    } else {
        console.error("cartLink element not found!");
    }
});

function toggleCart() {
    const cartSidebar = document.getElementById("cartSidebar");

    // Toggle sidebar visibility
    if (cartSidebar.classList.contains("translate-x-full")) {
        cartSidebar.classList.remove("translate-x-full");
        cartSidebar.classList.add("translate-x-0");
        loadCartItems(); // Load items when opening
    } else {
        cartSidebar.classList.remove("translate-x-0");
        cartSidebar.classList.add("translate-x-full");
    }
}

function loadCartItems() {
    const cartItemsContainer = document.getElementById("cartItemsContainer");
    if (!cartItemsContainer) {
        console.error("Cart container not found!");
        return;
    }

    cartItemsContainer.innerHTML = ""; // Clear previous content

    let cart = JSON.parse(localStorage.getItem("itemsInCart")) || [];
    console.log("Loaded Cart Data:", cart);

    if (!Array.isArray(cart) || cart.length === 0) {
        cartItemsContainer.innerHTML = "<p class='text-center text-gray-500'>Your cart is empty.</p>";
        return;
    }

    cart.forEach((item, index) => {
        const cartItem = document.createElement("div");
        cartItem.className = "flex items-center justify-between p-3 border-b";

        cartItem.innerHTML = `
            <div class="flex items-center space-x-3">
                <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded">
                <div>
                    <p class="font-semibold">${item.name}</p>
                    <p class="text-gray-600">${item.price}</p>

                </div>
<button id="orderNowBtn" class="bg-gradient-to-r from-green-400 to-green-600 text-white font-bold py-2 px-6 rounded-2xl shadow-lg hover:scale-105 transition-transform duration-200">
    Order Now
</button>
            </div>
 
            <button class="remove-btn text-red-500"  data-index="${index}">&times;</button>
        `;

        cartItemsContainer.appendChild(cartItem);
    });

    // Attach event listeners to remove buttons
    document.querySelectorAll(".remove-btn").forEach(button => {
        button.addEventListener("click", function () {
            const index = parseInt(this.getAttribute("data-index"));
            removeFromCart(index);
        });
    });
}

// Function to remove item from cart
function removeFromCart(index) {
    let cart = JSON.parse(localStorage.getItem("itemsInCart")) || [];
    cart.splice(index, 1);
    localStorage.setItem("itemsInCart", JSON.stringify(cart));
    loadCartItems(); // Refresh cart display
}




document.addEventListener("DOMContentLoaded", function () {
    // Order Sidebar Toggle
    const orderLink = document.getElementById("order");

    if (orderLink) {
        orderLink.addEventListener("click", function (event) {
            event.preventDefault();
            toggleOrderSidebar();
        });
    }

    // Function to toggle the order sidebar
    function toggleOrderSidebar() {
        const orderSidebar = document.getElementById("orderSidebar");

        if (orderSidebar.classList.contains("translate-x-full")) {
            orderSidebar.classList.remove("translate-x-full");
            orderSidebar.classList.add("translate-x-0");
            loadOrders(); // Load orders when opening
        } else {
            orderSidebar.classList.remove("translate-x-0");
            orderSidebar.classList.add("translate-x-full");
        }
    }

    // Function to load orders from localStorage
    function loadOrders() {
        const orderItemsContainer = document.getElementById("orderItemsContainer");
        if (!orderItemsContainer) {
            console.error("Order container not found!");
            return;
        }

        orderItemsContainer.innerHTML = ""; // Clear previous content

        let orders = JSON.parse(localStorage.getItem("orderItems")) || [];

        if (!Array.isArray(orders) || orders.length === 0) {
            orderItemsContainer.innerHTML = "<p class='text-center text-gray-500'>No orders placed yet.</p>";
            return;
        }

        orders.forEach((order, index) => {
            const orderItem = document.createElement("div");
            orderItem.className = "flex flex-col p-3 border-b bg-gray-50 rounded-lg shadow-md";

            // Set status color dynamically
            let statusColor = "text-yellow-600"; // Default Pending
            if (order.status === "Completed") statusColor = "text-green-600";
            if (order.status === "Canceled" || order.status === "Not Available") statusColor = "text-red-500";

            orderItem.innerHTML = `
                <div class="flex items-center space-x-3">
                    <img src="${order.image}" alt="${order.name}" class="w-16 h-16 object-cover rounded">
                    <div>
                        <p class="font-semibold">${order.name}</p>
                        <p class="text-gray-600">${order.price}</p>
                        <p class="text-sm ${statusColor}">Status: <span class="order-status">${order.status}</span></p>
                        <p class="text-sm text-red-500">Time Remaining: <span class="order-timer">${formatTime(order.time)}</span></p>
                    </div>
                </div>
                <button class="cancel-order bg-red-500 text-white text-sm px-3 py-1 rounded mt-2 w-full">
                    Cancel Order
                </button>
            `;

            orderItemsContainer.appendChild(orderItem);

            // Start the countdown timer
            startOrderTimer(order, index, orderItem);

            // Attach cancel order event listener
            orderItem.querySelector(".cancel-order").addEventListener("click", function () {
                cancelOrder(index);
            });
        });
    }

    // Function to start order timer (Loads from localStorage)
  // Function to start order timer (Loads from localStorage)
function startOrderTimer(order, index, orderItem) {
    let timeRemaining = parseInt(order.time) || 900; // Default 15 minutes if no time is provided
    const timerElement = orderItem.querySelector(".order-timer");

    const timerInterval = setInterval(() => {
        let orders = JSON.parse(localStorage.getItem("orderItems")) || [];
        if (timeRemaining <= 0) {
            clearInterval(timerInterval);
            timerElement.textContent = "Completed!";
            updateOrderStatus(index, "Completed");
        } else {
            timeRemaining--;
            timerElement.textContent = formatTime(timeRemaining);
            orders[index].time = timeRemaining; // Save updated time
            localStorage.setItem("orderItems", JSON.stringify(orders));
        }
    }, 1000);
}

    // Function to format time in MM:SS
    function formatTime(seconds) {
        if (seconds <= 0) return "Completed!";
        let minutes = Math.floor(seconds / 60);
        let secs = seconds % 60;
        return `${minutes}:${secs < 10 ? "0" : ""}${secs}`;
    }

    // Function to update order status in localStorage
    function updateOrderStatus(index, newStatus) {
        let orders = JSON.parse(localStorage.getItem("orderItems")) || [];
        orders[index].status = newStatus;
        localStorage.setItem("orderItems", JSON.stringify(orders));
        loadOrders(); // Refresh the order sidebar
    }

    // Function to cancel an order
    function cancelOrder(index) {
        let orders = JSON.parse(localStorage.getItem("orderItems")) || [];
        orders[index].status = "Canceled"; // Instead of deleting, mark as canceled
        orders[index].time = 0; // Set time to 0
        localStorage.setItem("orderItems", JSON.stringify(orders));
        loadOrders(); // Refresh order sidebar
    }

    
    // Function to place an order (Called from "Order Now" button)
// Function to place an order (Called from "Order Now" button)
function orderNow(name, price, image, time = 900) {
    let orders = JSON.parse(localStorage.getItem("orderItems")) || [];

    let orderItem = {
        name: name,
        price: price,
        image: image,
        status: "Pending",
        time: parseInt(time) || 900 // Default to 900 seconds if no valid time is provided
    };

    orders.push(orderItem);
    localStorage.setItem("orderItems", JSON.stringify(orders));

    alert(`✅ Order placed for ${name} (Time: ${formatTime(orderItem.time)})`);
}

});

 

</script>

    <script src="script.js"></script>
</body>
</html>
